<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KarChain | Sovereign Layer-1 Blockchain</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #020402;
            color: #ffffff;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            position: relative;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: #0a0f0a; }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #22c55e, #16a34a);
            border-radius: 6px;
            border: 2px solid #0a0f0a;
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 30px rgba(74, 222, 128, 0.3); }
            50% { box-shadow: 0 0 60px rgba(74, 222, 128, 0.6); }
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes spin-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.95); opacity: 0.5; }
            50% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.5; }
        }

        /* Custom Classes */
        .glass-panel {
            background: rgba(10, 15, 10, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(74, 222, 128, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .glass-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.01));
            border: 1px solid rgba(74, 222, 128, 0.1);
            backdrop-filter: blur(12px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:hover {
            border-color: rgba(74, 222, 128, 0.4);
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px -20px rgba(74, 222, 128, 0.5);
        }

        .btn-primary {
            background: linear-gradient(135deg, #15803d, #16a34a);
            color: white;
            font-weight: 600;
            padding: 12px 32px;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
            border: 1px solid rgba(74, 222, 128, 0.3);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .btn-primary:hover::before { left: 100%; }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(34, 197, 94, 0.4);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 12px 32px;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            border-color: rgba(74, 222, 128, 0.5);
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }

        .gradient-text {
            background: linear-gradient(90deg, #fff, #4ade80, #22c55e, #4ade80, #fff);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: gradient 8s ease infinite;
        }

        .floating { animation: float 6s ease-in-out infinite; }
        .glow { animation: glow 3s ease-in-out infinite; }
        .spin-slow { animation: spin-slow 20s linear infinite; }

        .bg-grid {
            background-image: 
                linear-gradient(rgba(74, 222, 128, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(74, 222, 128, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .hero-orb {
            position: absolute;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(74, 222, 128, 0.15) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(60px);
            animation: pulse-ring 8s ease-in-out infinite;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(74, 222, 128, 0.1);
            border-radius: 20px;
            padding: 24px;
            transition: all 0.3s;
        }

        .stat-card:hover {
            border-color: rgba(74, 222, 128, 0.4);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px -15px #4ade80;
        }

        .network-node {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            position: absolute;
            box-shadow: 0 0 20px #4ade80;
        }

        .toast-notification {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 16px 24px;
            background: rgba(10, 15, 10, 0.95);
            backdrop-filter: blur(10px);
            border-left: 4px solid #4ade80;
            border-radius: 12px;
            color: white;
            z-index: 9999;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
        }

        .toast-notification.show { transform: translateX(0); }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 9998;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .modal-backdrop.show {
            opacity: 1;
            pointer-events: all;
        }

        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: #0a0f0a;
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 24px;
            padding: 32px;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s;
            max-width: 450px;
            width: 90%;
        }

        .modal.show {
            opacity: 1;
            pointer-events: all;
            transform: translate(-50%, -50%) scale(1);
        }

        .wallet-option {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .wallet-option:hover {
            background: rgba(74, 222, 128, 0.1);
            border-color: #4ade80;
            transform: translateX(5px);
        }

        .faq-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            margin-bottom: 12px;
            overflow: hidden;
        }

        .faq-question {
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .faq-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s;
            color: #9ca3af;
        }

        .faq-answer.open {
            padding: 0 20px 20px;
            max-height: 200px;
        }

        .loader {
            width: 48px;
            height: 48px;
            border: 3px solid rgba(74, 222, 128, 0.3);
            border-radius: 50%;
            border-top-color: #4ade80;
            animation: spin-slow 1s linear infinite;
        }

        .input-field {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 14px 16px;
            color: white;
            width: 100%;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: #4ade80;
            box-shadow: 0 0 0 2px rgba(74, 222, 128, 0.2);
        }

        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .transaction-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .transaction-item:hover {
            background: rgba(74, 222, 128, 0.05);
            border-color: rgba(74, 222, 128, 0.3);
        }

        .timer-flip {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(74, 222, 128, 0.3);
            border-radius: 8px;
            padding: 8px 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 24px;
            color: #4ade80;
        }

        .page {
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .page.active {
            display: block;
            opacity: 1;
        }

        .mobile-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 300px;
            height: 100vh;
            background: #0a0f0a;
            border-left: 1px solid rgba(74, 222, 128, 0.2);
            z-index: 9997;
            transition: right 0.3s;
            padding: 100px 20px 20px;
        }

        .mobile-menu.open { right: 0; }

        .hamburger {
            display: none;
            flex-direction: column;
            gap: 6px;
            cursor: pointer;
            z-index: 9998;
        }

        .hamburger span {
            width: 30px;
            height: 3px;
            background: #4ade80;
            border-radius: 3px;
            transition: all 0.3s;
        }

        .hamburger.open span:nth-child(1) { transform: rotate(45deg) translate(6px, 6px); }
        .hamburger.open span:nth-child(2) { opacity: 0; }
        .hamburger.open span:nth-child(3) { transform: rotate(-45deg) translate(7px, -7px); }

        @media (max-width: 768px) {
            .desktop-nav { display: none; }
            .hamburger { display: flex; }
        }

        .badge {
            padding: 4px 12px;
            border-radius: 100px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-success { background: rgba(74, 222, 128, 0.2); color: #4ade80; border: 1px solid rgba(74, 222, 128, 0.3); }
        .badge-warning { background: rgba(245, 158, 11, 0.2); color: #f59e0b; border: 1px solid rgba(245, 158, 11, 0.3); }
        .badge-error { background: rgba(239, 68, 68, 0.2); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3); }

        .feature-card {
            background: linear-gradient(145deg, rgba(74, 222, 128, 0.05), rgba(74, 222, 128, 0.01));
            border: 1px solid rgba(74, 222, 128, 0.1);
            border-radius: 24px;
            padding: 32px;
            transition: all 0.4s;
        }

        .feature-card:hover {
            border-color: #4ade80;
            transform: translateY(-10px);
            box-shadow: 0 20px 40px -20px #4ade80;
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: rgba(74, 222, 128, 0.1);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 24px;
            font-size: 24px;
            color: #4ade80;
            transition: all 0.3s;
        }

        .feature-card:hover .feature-icon {
            background: #4ade80;
            color: #020402;
            transform: scale(1.1) rotate(5deg);
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #22c55e, #4ade80);
            border-radius: 4px;
            transition: width 0.3s;
        }

        .token-price {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(74, 222, 128, 0.1);
            padding: 4px 12px;
            border-radius: 100px;
            border: 1px solid rgba(74, 222, 128, 0.2);
        }
    </style>
</head>

<body class="bg-[#020402] text-white antialiased">
    <!-- Background Effects -->
    <div class="fixed inset-0 bg-grid opacity-30 pointer-events-none"></div>
    <div class="hero-orb fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none"></div>
    
    <!-- Network Nodes Animation -->
    <div class="fixed inset-0 pointer-events-none">
        <div class="network-node" style="top: 20%; left: 15%;"></div>
        <div class="network-node" style="top: 70%; left: 85%; animation-delay: 2s;"></div>
        <div class="network-node" style="top: 40%; left: 45%; animation-delay: 1s;"></div>
        <div class="network-node" style="top: 80%; left: 25%; animation-delay: 3s;"></div>
        <div class="network-node" style="top: 15%; left: 75%; animation-delay: 1.5s;"></div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast-notification">
        <div class="flex items-center gap-3">
            <i id="toastIcon" class="fa-solid fa-info-circle text-green-400 text-xl"></i>
            <div>
                <div id="toastTitle" class="font-bold mb-1">Info</div>
                <div id="toastMessage" class="text-sm text-gray-300"></div>
            </div>
        </div>
    </div>

    <!-- Connect Wallet Modal -->
    <div id="modalBackdrop" class="modal-backdrop" onclick="closeModal()"></div>
    <div id="walletModal" class="modal">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold">Connect Wallet</h3>
            <button onclick="closeModal()" class="text-gray-400 hover:text-white text-xl">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <p class="text-gray-400 text-sm mb-8">Choose your preferred wallet to interact with KarChain</p>
        
        <div class="wallet-option" onclick="connectWallet('metamask')">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg" class="w-10 h-10">
            <div>
                <div class="font-bold">MetaMask</div>
                <div class="text-xs text-gray-400">Browser Extension</div>
            </div>
            <i class="fa-solid fa-chevron-right ml-auto text-gray-500"></i>
        </div>
        
        <div class="wallet-option" onclick="connectWallet('walletconnect')">
            <i class="fa-solid fa-qrcode text-3xl text-blue-400"></i>
            <div>
                <div class="font-bold">WalletConnect</div>
                <div class="text-xs text-gray-400">Scan with mobile</div>
            </div>
            <i class="fa-solid fa-chevron-right ml-auto text-gray-500"></i>
        </div>
        
        <div class="wallet-option" onclick="connectWallet('trust')">
            <i class="fa-solid fa-shield-halved text-3xl text-blue-600"></i>
            <div>
                <div class="font-bold">Trust Wallet</div>
                <div class="text-xs text-gray-400">Mobile wallet</div>
            </div>
            <i class="fa-solid fa-chevron-right ml-auto text-gray-500"></i>
        </div>
        
        <p class="text-center text-xs text-gray-500 mt-6">
            By connecting, you agree to our Terms of Service
        </p>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-green-500/10">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <!-- Logo -->
            <div class="flex items-center gap-3 cursor-pointer group" onclick="navigateTo('home')">
                <div class="w-12 h-12 relative">
                    <svg viewBox="0 0 100 100" class="w-full h-full drop-shadow-[0_0_20px_rgba(74,222,128,0.5)]">
                        <path d="M20 10 V90" stroke="#4ade80" stroke-width="8" stroke-linecap="round"/>
                        <path d="M80 10 L20 50 L80 90" stroke="#4ade80" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="20" cy="50" r="10" fill="#22c55e"/>
                        <circle cx="80" cy="10" r="8" fill="#22c55e"/>
                        <circle cx="80" cy="90" r="8" fill="#22c55e"/>
                    </svg>
                </div>
                <div>
                    <span class="text-xl font-bold tracking-wider font-display">KARCHAIN</span>
                    <span class="text-[10px] text-green-500 block">SOVEREIGN LAYER 1</span>
                </div>
            </div>

            <!-- Desktop Navigation -->
            <div class="desktop-nav flex items-center gap-8">
                <button onclick="navigateTo('home')" class="nav-link text-white font-medium hover:text-green-400 transition-colors">Testnet</button>
                <button onclick="navigateTo('vision')" class="nav-link text-gray-400 font-medium hover:text-white transition-colors">Vision</button>
                <button onclick="navigateTo('ecosystem')" class="nav-link text-gray-400 font-medium hover:text-white transition-colors">Ecosystem</button>
                <button onclick="navigateTo('support')" class="nav-link text-gray-400 font-medium hover:text-white transition-colors">Support</button>
            </div>

            <!-- Right Section -->
            <div class="flex items-center gap-4">
                <button id="walletButton" onclick="openModal()" class="btn-primary flex items-center gap-2">
                    <i class="fa-solid fa-wallet"></i>
                    <span>Connect Wallet</span>
                </button>
                
                <!-- Hamburger Menu -->
                <div class="hamburger" id="hamburger" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu">
        <div class="flex flex-col gap-6">
            <button onclick="navigateTo('home'); toggleMobileMenu()" class="text-xl font-bold text-white hover:text-green-400 transition-colors">Testnet</button>
            <button onclick="navigateTo('vision'); toggleMobileMenu()" class="text-xl font-bold text-gray-400 hover:text-white transition-colors">Vision</button>
            <button onclick="navigateTo('ecosystem'); toggleMobileMenu()" class="text-xl font-bold text-gray-400 hover:text-white transition-colors">Ecosystem</button>
            <button onclick="navigateTo('support'); toggleMobileMenu()" class="text-xl font-bold text-gray-400 hover:text-white transition-colors">Support</button>
            
            <div class="border-t border-white/10 my-4"></div>
            
            <div id="mobileWalletInfo" class="hidden">
                <div class="glass-panel p-4 rounded-xl">
                    <p class="text-sm text-gray-400 mb-2">Connected</p>
                    <p id="mobileAddress" class="font-mono text-xs break-all"></p>
                    <p id="mobileBalance" class="text-lg font-bold mt-2"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="pt-32 pb-20 px-4 max-w-7xl mx-auto">
        <!-- HOME PAGE -->
        <div id="home-page" class="page active">
            <!-- Hero Section -->
            <div class="text-center mb-20 relative">
                <div class="inline-block mb-6">
                    <span class="badge badge-success">
                        <i class="fa-solid fa-circle-nodes mr-2"></i>
                        INCENTIVIZED TESTNET PHASE 1
                    </span>
                </div>
                
                <h1 class="text-6xl md:text-8xl font-bold mb-8 leading-tight">
                    THE ARCHITECTURE OF
                    <span class="gradient-text block mt-2">DIGITAL TRUST</span>
                </h1>
                
                <p class="text-xl text-gray-400 max-w-3xl mx-auto mb-12 leading-relaxed">
                    KarChain is the first hyper-scalable Layer-1 blockchain featuring Adaptive State Sharding 
                    and Proof-of-Synchrony consensus. Join the incentivized testnet and shape the future.
                </p>
                
                <div class="flex flex-wrap justify-center gap-4 mb-16">
                    <button onclick="openModal()" class="btn-primary px-8 py-4 text-lg">
                        <i class="fa-solid fa-rocket mr-2"></i>
                        Launch Testnet
                    </button>
                    <a href="https://docs.karchain.network" target="_blank" class="btn-secondary px-8 py-4 text-lg">
                        <i class="fa-solid fa-book mr-2"></i>
                        Documentation
                    </a>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 max-w-5xl mx-auto">
                    <div class="stat-card">
                        <div class="text-4xl font-bold text-white mb-2" id="statBlocks">12,492</div>
                        <div class="text-sm text-gray-400">Blocks Finalized</div>
                    </div>
                    <div class="stat-card">
                        <div class="text-4xl font-bold text-white mb-2" id="statTxs">15.8K</div>
                        <div class="text-sm text-gray-400">Transactions</div>
                    </div>
                    <div class="stat-card">
                        <div class="text-4xl font-bold text-white mb-2" id="statValidators">138</div>
                        <div class="text-sm text-gray-400">Active Validators</div>
                    </div>
                    <div class="stat-card">
                        <div class="text-4xl font-bold text-white mb-2" id="statTPS">4,892</div>
                        <div class="text-sm text-gray-400">TPS</div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div class="glass-panel rounded-3xl p-1 glow">
                <div class="bg-[#0a0f0a] rounded-[23px] p-8">
                    <!-- Locked View -->
                    <div id="lockedView" class="text-center py-16">
                        <div class="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fa-solid fa-lock text-4xl text-gray-500"></i>
                        </div>
                        <h2 class="text-3xl font-bold mb-3">Dashboard Locked</h2>
                        <p class="text-gray-400 mb-8 max-w-md mx-auto">
                            Connect your wallet to access the testnet dashboard, claim daily tokens, 
                            and complete incentivized tasks.
                        </p>
                        <button onclick="openModal()" class="btn-primary px-12 py-4 text-lg">
                            <i class="fa-solid fa-wallet mr-2"></i>
                            Connect Wallet
                        </button>
                    </div>

                    <!-- Active View -->
                    <div id="activeView" class="hidden">
                        <!-- Header -->
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 pb-8 border-b border-white/10">
                            <div>
                                <div class="flex items-center gap-2 text-green-400 mb-2">
                                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                    <span class="text-xs font-bold uppercase tracking-wider">Connected to KarChain</span>
                                </div>
                                <p class="text-sm text-gray-400 mb-1">Available Balance</p>
                                <div class="flex items-baseline gap-3">
                                    <span id="krmBalance" class="text-5xl md:text-6xl font-bold font-mono">0.00</span>
                                    <span class="text-2xl font-bold text-green-500 bg-green-500/10 px-4 py-2 rounded-lg">KRM</span>
                                </div>
                            </div>
                            <div class="mt-6 md:mt-0">
                                <div class="flex items-center gap-4">
                                    <div>
                                        <p class="text-xs text-gray-400">Wallet Address</p>
                                        <p id="walletAddress" class="text-sm font-mono bg-white/5 px-3 py-2 rounded-lg"></p>
                                    </div>
                                    <button onclick="refreshBalance()" class="text-gray-400 hover:text-green-400 transition-colors">
                                        <i class="fa-solid fa-rotate"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Send Transaction -->
                        <div class="glass-card rounded-2xl p-6 mb-8">
                            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                                <i class="fa-solid fa-paper-plane text-green-400"></i>
                                Send Transaction
                            </h3>
                            
                            <button onclick="sendToSelf()" class="w-full py-4 bg-blue-600 hover:bg-blue-700 rounded-xl font-bold mb-6 transition-all">
                                <i class="fa-solid fa-user mr-2"></i>
                                SEND TO SELF (0.001 KRM)
                            </button>
                            
                            <div class="relative my-8">
                                <div class="absolute inset-0 flex items-center">
                                    <div class="w-full border-t border-white/10"></div>
                                </div>
                                <div class="relative flex justify-center">
                                    <span class="px-4 bg-[#0a0f0a] text-gray-500 text-sm">OR SEND TO OTHER ADDRESS</span>
                                </div>
                            </div>
                            
                            <div class="space-y-4">
                                <input type="text" id="recipientAddress" placeholder="Recipient Address (0x...)" 
                                       class="input-field font-mono">
                                <div class="flex gap-4">
                                    <input type="number" id="sendAmount" placeholder="Amount (KRM)" step="0.001" min="0.001"
                                           class="input-field flex-1">
                                    <button onclick="sendTransaction()" class="btn-primary px-8">
                                        SEND
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Faucet Section -->
                        <div class="grid md:grid-cols-2 gap-6 mb-8">
                            <!-- Level 1 Faucet -->
                            <div class="glass-card rounded-2xl p-6">
                                <div class="flex items-center gap-4 mb-6">
                                    <div class="feature-icon !w-16 !h-16 !mb-0">
                                        <i class="fa-solid fa-droplet text-2xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-xl font-bold">Level 1 Faucet</h4>
                                        <p class="text-sm text-gray-400">1 KRM every 24 hours</p>
                                    </div>
                                </div>
                                <div id="faucetLevel1" class="space-y-3"></div>
                            </div>

                            <!-- Level 2 Faucet -->
                            <div class="glass-card rounded-2xl p-6" id="level2Card">
                                <div class="flex items-center gap-4 mb-6">
                                    <div class="feature-icon !w-16 !h-16 !mb-0">
                                        <i class="fa-brands fa-ethereum text-2xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-xl font-bold">Level 2 Faucet</h4>
                                        <p class="text-sm text-gray-400">5 KRM for 0.005 ETH</p>
                                    </div>
                                </div>
                                <div id="faucetLevel2"></div>
                            </div>
                        </div>

                        <!-- Transaction History -->
                        <div class="mt-8">
                            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                                <i class="fa-solid fa-clock-rotate-left text-green-400"></i>
                                Recent Transactions
                                <button onclick="loadTransactionHistory()" class="ml-auto text-sm text-green-400 hover:text-green-300">
                                    <i class="fa-solid fa-rotate mr-1"></i>Refresh
                                </button>
                            </h3>
                            <div id="transactionList" class="space-y-3 max-h-96 overflow-y-auto pr-2"></div>
                            <div id="noTransactions" class="text-center py-12 text-gray-500 hidden">
                                <i class="fa-solid fa-receipt text-5xl mb-4 opacity-50"></i>
                                <p>No transactions yet</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Features Grid -->
            <div class="grid md:grid-cols-3 gap-8 mt-20">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fa-solid fa-bolt"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3">Proof-of-Synchrony</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">
                        Novel consensus mechanism achieving mathematical finality in sub-second timeframes
                    </p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fa-solid fa-shield-halved"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3">Post-Quantum Security</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">
                        Lattice-based cryptography protecting against quantum computing threats
                    </p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fa-solid fa-cubes"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3">Adaptive Sharding</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">
                        Dynamic shard allocation for infinite horizontal scalability
                    </p>
                </div>
            </div>
        </div>

        <!-- VISION PAGE -->
        <div id="vision-page" class="page">
            <div class="text-center mb-16">
                <span class="badge badge-success mb-4">OUR VISION</span>
                <h2 class="text-5xl md:text-7xl font-bold mb-6">THE <span class="gradient-text">MANIFESTO</span></h2>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    Re-engineering the fundamental substrate of human coordination for the 22nd century
                </p>
            </div>

            <div class="grid lg:grid-cols-2 gap-12 items-center mb-20">
                <div class="space-y-8">
                    <div class="glass-panel p-8 rounded-2xl border-l-4 border-green-500">
                        <h3 class="text-2xl font-bold mb-4 flex items-center gap-3">
                            <span class="text-green-400">01</span>
                            Asynchronous Finality
                        </h3>
                        <p class="text-gray-300 leading-relaxed">
                            KarChain introduces Hyper-Graph Sharding, partitioning state into thousands of 
                            concurrent execution threads. Using Proof-of-Synchrony, we achieve mathematical 
                            finality in sub-second timeframes.
                        </p>
                    </div>
                    <div class="glass-panel p-8 rounded-2xl hover:border-green-500/50 transition-all">
                        <h3 class="text-2xl font-bold mb-4 flex items-center gap-3">
                            <span class="text-green-400">02</span>
                            Quantum Resistance
                        </h3>
                        <p class="text-gray-300 leading-relaxed">
                            Built as a Quantum Fortress utilizing Lattice-based signatures (Kyber/Dilithium) 
                            to secure assets against future quantum decryption threats.
                        </p>
                    </div>
                </div>
                
                <div class="relative h-[400px] flex items-center justify-center">
                    <div class="absolute inset-0 bg-green-500/20 blur-[100px] rounded-full animate-pulse"></div>
                    <div class="relative spin-slow">
                        <div class="w-64 h-64 border-2 border-green-500/30 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div>
                        <div class="w-48 h-48 border-2 border-green-500/50 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div>
                        <div class="w-32 h-32 border-2 border-green-500 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div>
                        <i class="fa-solid fa-infinity text-8xl text-green-400 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></i>
                    </div>
                </div>
            </div>

            <!-- Roadmap -->
            <div class="glass-panel rounded-3xl p-12">
                <h3 class="text-3xl font-bold text-center mb-12">Strategic Roadmap</h3>
                <div class="grid md:grid-cols-4 gap-8">
                    <div class="text-center">
                        <div class="w-12 h-12 bg-green-500 rounded-full mx-auto mb-4 glow"></div>
                        <h4 class="text-green-400 font-bold mb-2">PHASE 1</h4>
                        <p class="text-white font-bold">Genesis</p>
                        <p class="text-sm text-gray-500 mt-2">Testnet launch, Faucet activation</p>
                    </div>
                    <div class="text-center">
                        <div class="w-12 h-12 bg-gray-700 rounded-full mx-auto mb-4"></div>
                        <h4 class="text-gray-400 font-bold mb-2">PHASE 2</h4>
                        <p class="text-white font-bold">Incentivized</p>
                        <p class="text-sm text-gray-500 mt-2">Stress testing, Bug bounties</p>
                    </div>
                    <div class="text-center">
                        <div class="w-12 h-12 bg-gray-700 rounded-full mx-auto mb-4"></div>
                        <h4 class="text-gray-400 font-bold mb-2">PHASE 3</h4>
                        <p class="text-white font-bold">Ignition</p>
                        <p class="text-sm text-gray-500 mt-2">Mainnet launch, TGE</p>
                    </div>
                    <div class="text-center">
                        <div class="w-12 h-12 bg-gray-700 rounded-full mx-auto mb-4"></div>
                        <h4 class="text-gray-400 font-bold mb-2">PHASE 4</h4>
                        <p class="text-white font-bold">Singularity</p>
                        <p class="text-sm text-gray-500 mt-2">Global settlement layer</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ECOSYSTEM PAGE -->
        <div id="ecosystem-page" class="page">
            <div class="text-center mb-16">
                <span class="badge badge-success mb-4">ECOSYSTEM</span>
                <h2 class="text-5xl md:text-7xl font-bold mb-6">BUILDING THE <span class="gradient-text">FUTURE</span></h2>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    Explore the growing ecosystem of dApps and protocols on KarChain
                </p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="glass-card p-8 rounded-2xl group cursor-pointer">
                    <div class="feature-icon group-hover:bg-purple-500 group-hover:text-white">
                        <i class="fa-solid fa-arrow-right-arrow-left"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">KarSwap DEX</h3>
                    <p class="text-gray-400 text-sm mb-4">Native AMM with concentrated liquidity and zero slippage</p>
                    <span class="badge badge-success">Live on Testnet</span>
                </div>

                <div class="glass-card p-8 rounded-2xl group cursor-pointer">
                    <div class="feature-icon group-hover:bg-blue-500 group-hover:text-white">
                        <i class="fa-solid fa-vault"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">KarVault Lending</h3>
                    <p class="text-gray-400 text-sm mb-4">Cross-chain lending with undercollateralized loans</p>
                    <span class="badge badge-warning">Coming Q2 2025</span>
                </div>

                <div class="glass-card p-8 rounded-2xl group cursor-pointer">
                    <div class="feature-icon group-hover:bg-emerald-500 group-hover:text-white">
                        <i class="fa-solid fa-shield-halved"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">KarSafe</h3>
                    <p class="text-gray-400 text-sm mb-4">Multi-sig institutional wallet with MPC</p>
                    <span class="badge badge-success">Audited</span>
                </div>

                <div class="glass-card p-8 rounded-2xl group cursor-pointer">
                    <div class="feature-icon group-hover:bg-cyan-500 group-hover:text-white">
                        <i class="fa-solid fa-bridge"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">KarBridge</h3>
                    <p class="text-gray-400 text-sm mb-4">ZK-proof cross-chain bridge</p>
                    <span class="badge badge-warning">In Development</span>
                </div>

                <div class="glass-card p-8 rounded-2xl group cursor-pointer">
                    <div class="feature-icon group-hover:bg-yellow-500 group-hover:text-white">
                        <i class="fa-solid fa-chart-line"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">KarOracle</h3>
                    <p class="text-gray-400 text-sm mb-4">Decentralized oracle network</p>
                    <span class="badge badge-success">Testnet</span>
                </div>

                <div class="glass-card p-8 rounded-2xl group cursor-pointer">
                    <div class="feature-icon group-hover:bg-pink-500 group-hover:text-white">
                        <i class="fa-solid fa-rocket"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">KarLaunch</h3>
                    <p class="text-gray-400 text-sm mb-4">Fair launch platform</p>
                    <span class="badge badge-warning">Q3 2025</span>
                </div>
            </div>

            <!-- Partners -->
            <div class="mt-20">
                <h3 class="text-2xl font-bold text-center mb-12">Strategic Partners</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                    <div class="glass-panel p-6 rounded-xl text-center">
                        <i class="fa-solid fa-server text-4xl text-blue-400 mb-3"></i>
                        <p class="font-bold">Infrastructure</p>
                    </div>
                    <div class="glass-panel p-6 rounded-xl text-center">
                        <i class="fa-solid fa-shield text-4xl text-green-400 mb-3"></i>
                        <p class="font-bold">Security</p>
                    </div>
                    <div class="glass-panel p-6 rounded-xl text-center">
                        <i class="fa-solid fa-users text-4xl text-orange-400 mb-3"></i>
                        <p class="font-bold">Community</p>
                    </div>
                    <div class="glass-panel p-6 rounded-xl text-center">
                        <i class="fa-solid fa-code text-4xl text-purple-400 mb-3"></i>
                        <p class="font-bold">Development</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SUPPORT PAGE -->
        <div id="support-page" class="page">
            <div class="text-center mb-16">
                <span class="badge badge-success mb-4">SUPPORT</span>
                <h2 class="text-5xl md:text-7xl font-bold mb-6">COMMUNITY <span class="gradient-text">HUB</span></h2>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    Get support, report bugs, and connect with the team
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 mb-16">
                <a href="https://t.me/tgkarim1" target="_blank" class="glass-panel p-8 rounded-2xl group hover:border-blue-500/50 transition-all">
                    <div class="flex items-center gap-6">
                        <div class="w-20 h-20 bg-blue-500/20 rounded-2xl flex items-center justify-center text-3xl text-blue-400">
                            <i class="fa-brands fa-telegram"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold mb-2">Telegram</h3>
                            <p class="text-gray-400">Join 50,000+ members</p>
                        </div>
                    </div>
                </a>

                <a href="mailto:support@karchain.io" class="glass-panel p-8 rounded-2xl group hover:border-green-500/50 transition-all">
                    <div class="flex items-center gap-6">
                        <div class="w-20 h-20 bg-green-500/20 rounded-2xl flex items-center justify-center text-3xl text-green-400">
                            <i class="fa-solid fa-envelope"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold mb-2">Email Support</h3>
                            <p class="text-gray-400">support@karchain.io</p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- FAQ -->
            <h3 class="text-2xl font-bold mb-8">Frequently Asked Questions</h3>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>How to add KarChain to MetaMask?</span>
                    <i class="fa-solid fa-chevron-down text-green-400 transition-transform"></i>
                </div>
                <div class="faq-answer">
                    <p>Click "Connect Wallet" on our dashboard. The site will automatically prompt you to add the network.</p>
                    <div class="bg-white/5 p-4 rounded-xl font-mono text-xs mt-4">
                        <p>Network Name: KarChain Testnet</p>
                        <p>RPC URL: https://rpc.karchain.network</p>
                        <p>Chain ID: 1337</p>
                        <p>Currency Symbol: KRM</p>
                    </div>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>How does the faucet work?</span>
                    <i class="fa-solid fa-chevron-down text-green-400 transition-transform"></i>
                </div>
                <div class="faq-answer">
                    <p>Level 1: Claim 1 KRM every 24 hours for free.</p>
                    <p>Level 2: Send 0.005 ETH and receive 5 KRM (requires Level 1 completion).</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>What is the max supply?</span>
                    <i class="fa-solid fa-chevron-down text-green-400 transition-transform"></i>
                </div>
                <div class="faq-answer">
                    <p>Maximum supply of KRM is 1,000,000,000 tokens. No inflation after mainnet launch.</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-white/5 bg-[#0a0f0a] py-16">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid md:grid-cols-4 gap-12">
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center gap-3 mb-6">
                        <svg viewBox="0 0 100 100" class="w-12 h-12">
                            <path d="M20 10 V90" stroke="#4ade80" stroke-width="8"/>
                            <path d="M80 10 L20 50 L80 90" stroke="#4ade80" stroke-width="8"/>
                        </svg>
                        <span class="text-2xl font-bold">KARCHAIN</span>
                    </div>
                    <p class="text-gray-500 text-sm max-w-xs">
                        The sovereign consensus layer for the decentralized future.
                    </p>
                </div>
                
                <div>
                    <h4 class="font-bold mb-6">Ecosystem</h4>
                    <ul class="space-y-3 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-green-400 transition-colors">Explorer</a></li>
                        <li><a href="#" class="hover:text-green-400 transition-colors">Governance</a></li>
                        <li><a href="#" class="hover:text-green-400 transition-colors">Bridge</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-bold mb-6">Developers</h4>
                    <ul class="space-y-3 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-green-400 transition-colors">Documentation</a></li>
                        <li><a href="#" class="hover:text-green-400 transition-colors">GitHub</a></li>
                        <li><a href="#" class="hover:text-green-400 transition-colors">Audits</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-12 pt-8 border-t border-white/5 text-center text-sm text-gray-600">
                 2026 KarChain Foundation. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Scroll to Top -->
    <button id="scrollTop" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
            class="fixed bottom-8 right-8 w-14 h-14 bg-green-500 rounded-full flex items-center justify-center text-white shadow-lg opacity-0 pointer-events-none transition-opacity">
        <i class="fa-solid fa-chevron-up"></i>
    </button>

    <script>
        // ==================== CONFIGURATION ====================
        const CONFIG = {
            chainId: 1337,
            chainIdHex: '0x539',
            rpcUrl: 'https://relationless-improperly-nettie.ngrok-free.dev',
            faucetAddress: '0x742d35Cc6634C0532925a3b844Bc454e4438f44e',
            chainName: 'KarChain Testnet',
            currencySymbol: 'KRM',
            explorer: 'https://explorer.karchain.network'
        };

        // ==================== STATE ====================
        let provider = null;
        let signer = null;
        let userAddress = null;
        let krmBalance = 0;
        let transactions = JSON.parse(localStorage.getItem('karchain_txs') || '[]');
        let refreshInterval = null;

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
            startStatsSimulation();
            checkSavedConnection();
            setupScrollListener();
        });

        function initializeApp() {
            loadTransactionHistory();
            updateFaucetUI();
            animateElements();
            
            // Set initial stats
            document.getElementById('statBlocks').textContent = '12,492';
            document.getElementById('statTxs').textContent = '15.8K';
            document.getElementById('statValidators').textContent = '138';
            document.getElementById('statTPS').textContent = '4,892';
        }

        // ==================== ANIMATIONS ====================
        function animateElements() {
            if (typeof gsap !== 'undefined') {
                gsap.from('.feature-card', {
                    scrollTrigger: {
                        trigger: '.feature-card',
                        start: 'top 80%'
                    },
                    y: 50,
                    opacity: 0,
                    duration: 0.8,
                    stagger: 0.2
                });
            }
        }

        // ==================== STATS SIMULATION ====================
        function startStatsSimulation() {
            setInterval(() => {
                if (document.getElementById('home-page').classList.contains('active')) {
                    const blocks = parseInt(document.getElementById('statBlocks').textContent.replace(/,/g, '')) + 1;
                    document.getElementById('statBlocks').textContent = blocks.toLocaleString();
                    
                    const txs = Math.floor(Math.random() * 100) + 15800;
                    document.getElementById('statTxs').textContent = (txs / 1000).toFixed(1) + 'K';
                }
            }, 5000);
        }

        // ==================== NAVIGATION ====================
        function navigateTo(page) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            
            // Show selected page
            document.getElementById(page + '-page').classList.add('active');
            
            // Update navigation links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('text-white');
                link.classList.add('text-gray-400');
            });
            
            // Find and highlight active link
            const activeLinks = Array.from(document.querySelectorAll('.nav-link')).filter(
                link => link.textContent.toLowerCase().includes(page)
            );
            activeLinks.forEach(link => {
                link.classList.remove('text-gray-400');
                link.classList.add('text-white');
            });
            
            // Close mobile menu
            closeMobileMenu();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ==================== MOBILE MENU ====================
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            const hamburger = document.getElementById('hamburger');
            menu.classList.toggle('open');
            hamburger.classList.toggle('open');
        }

        function closeMobileMenu() {
            document.getElementById('mobileMenu').classList.remove('open');
            document.getElementById('hamburger').classList.remove('open');
        }

        // ==================== MODAL ====================
        function openModal() {
            document.getElementById('modalBackdrop').classList.add('show');
            document.getElementById('walletModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('modalBackdrop').classList.remove('show');
            document.getElementById('walletModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        // ==================== TOAST ====================
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const icon = document.getElementById('toastIcon');
            const title = document.getElementById('toastTitle');
            const msg = document.getElementById('toastMessage');
            
            // Set colors based on type
            const colors = {
                success: { icon: 'fa-check-circle', color: 'text-green-400', title: 'Success' },
                error: { icon: 'fa-exclamation-circle', color: 'text-red-400', title: 'Error' },
                info: { icon: 'fa-info-circle', color: 'text-blue-400', title: 'Info' }
            };
            
            const config = colors[type] || colors.info;
            
            icon.className = `fa-solid ${config.icon} ${config.color} text-xl`;
            title.textContent = config.title;
            msg.textContent = message;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 5000);
        }

        // ==================== WALLET CONNECTION ====================
        async function connectWallet(walletType) {
            closeModal();
            
            try {
                if (!window.ethereum) {
                    window.open('https://metamask.io/download/', '_blank');
                    throw new Error('Please install MetaMask');
                }
                
                showToast('Connecting wallet...', 'info');
                
                // Request accounts
                provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send('eth_requestAccounts', []);
                signer = provider.getSigner();
                userAddress = await signer.getAddress();
                
                // Switch to KarChain network
                await switchNetwork();
                
                // Update UI
                await updateBalance();
                
                // Save connection
                localStorage.setItem('karchain_wallet', JSON.stringify({
                    address: userAddress,
                    connected: true,
                    timestamp: Date.now()
                }));
                
                // Update button
                const shortAddress = userAddress.substring(0, 6) + '...' + userAddress.substring(38);
                document.getElementById('walletButton').innerHTML = `
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse mr-2"></div>
                    <span>${shortAddress}</span>
                `;
                
                // Show dashboard
                document.getElementById('lockedView').classList.add('hidden');
                document.getElementById('activeView').classList.remove('hidden');
                
                // Update wallet info
                document.getElementById('walletAddress').textContent = shortAddress;
                document.getElementById('mobileAddress').textContent = userAddress;
                document.getElementById('mobileBalance').textContent = parseFloat(krmBalance).toFixed(4) + ' KRM';
                document.getElementById('mobileWalletInfo').classList.remove('hidden');
                
                // Setup event listeners
                window.ethereum.on('accountsChanged', handleAccountsChanged);
                window.ethereum.on('chainChanged', () => window.location.reload());
                
                // Start balance refresh
                if (refreshInterval) clearInterval(refreshInterval);
                refreshInterval = setInterval(updateBalance, 15000);
                
                showToast('Wallet connected successfully!', 'success');
                
                // Load transactions
                loadTransactionHistory();
                
            } catch (error) {
                console.error(error);
                showToast(error.message, 'error');
            }
        }

        async function switchNetwork() {
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: CONFIG.chainIdHex }]
                });
            } catch (switchError) {
                // Chain not added, add it
                if (switchError.code === 4902) {
                    try {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [{
                                chainId: CONFIG.chainIdHex,
                                chainName: CONFIG.chainName,
                                rpcUrls: [CONFIG.rpcUrl],
                                nativeCurrency: {
                                    name: 'KarChain',
                                    symbol: CONFIG.currencySymbol,
                                    decimals: 18
                                },
                                blockExplorerUrls: [CONFIG.explorer]
                            }]
                        });
                    } catch (addError) {
                        throw new Error('Failed to add KarChain network');
                    }
                }
            }
        }

        function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                disconnectWallet();
            } else if (accounts[0] !== userAddress) {
                userAddress = accounts[0];
                updateBalance();
            }
        }

        function disconnectWallet() {
            userAddress = null;
            provider = null;
            signer = null;
            krmBalance = 0;
            
            localStorage.removeItem('karchain_wallet');
            
            document.getElementById('walletButton').innerHTML = `
                <i class="fa-solid fa-wallet"></i>
                <span>Connect Wallet</span>
            `;
            
            document.getElementById('lockedView').classList.remove('hidden');
            document.getElementById('activeView').classList.add('hidden');
            document.getElementById('mobileWalletInfo').classList.add('hidden');
            
            if (refreshInterval) {
                clearInterval(refreshInterval);
                refreshInterval = null;
            }
            
            showToast('Wallet disconnected', 'info');
        }

        function checkSavedConnection() {
            const saved = localStorage.getItem('karchain_wallet');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    if (data.connected && data.address) {
                        setTimeout(() => connectWallet('saved'), 1000);
                    }
                } catch (e) {
                    console.error('Error parsing saved wallet');
                }
            }
        }

        // ==================== BALANCE ====================
        async function updateBalance() {
            if (!provider || !userAddress) return;
            
            try {
                const balance = await provider.getBalance(userAddress);
                krmBalance = ethers.utils.formatEther(balance);
                document.getElementById('krmBalance').textContent = parseFloat(krmBalance).toFixed(4);
                document.getElementById('mobileBalance').textContent = parseFloat(krmBalance).toFixed(4) + ' KRM';
            } catch (error) {
                console.error('Balance update failed:', error);
            }
        }

        function refreshBalance() {
            updateBalance();
            showToast('Balance updated', 'success');
        }

        // ==================== TRANSACTIONS ====================
        async function sendToSelf() {
            if (!signer || !userAddress) {
                showToast('Please connect wallet first', 'error');
                openModal();
                return;
            }
            
            try {
                showToast('Sending transaction...', 'info');
                
                const tx = await signer.sendTransaction({
                    to: userAddress,
                    value: ethers.utils.parseEther('0.001')
                });
                
                showToast(`Transaction sent: ${tx.hash.substring(0, 10)}...`, 'success');
                
                const receipt = await tx.wait();
                
                const txData = {
                    hash: tx.hash,
                    from: userAddress,
                    to: userAddress,
                    value: '0.001',
                    status: receipt.status === 1 ? 'success' : 'failed',
                    timestamp: Date.now()
                };
                
                transactions.push(txData);
                localStorage.setItem('karchain_txs', JSON.stringify(transactions));
                
                await updateBalance();
                loadTransactionHistory();
                
                showToast('Transaction confirmed!', 'success');
                
            } catch (error) {
                console.error(error);
                showToast(error.message, 'error');
            }
        }

        async function sendTransaction() {
            if (!signer || !userAddress) {
                showToast('Please connect wallet first', 'error');
                openModal();
                return;
            }
            
            const recipient = document.getElementById('recipientAddress').value.trim();
            const amount = document.getElementById('sendAmount').value;
            
            if (!recipient || !ethers.utils.isAddress(recipient)) {
                showToast('Invalid recipient address', 'error');
                return;
            }
            
            if (!amount || parseFloat(amount) <= 0) {
                showToast('Invalid amount', 'error');
                return;
            }
            
            try {
                showToast('Sending transaction...', 'info');
                
                const tx = await signer.sendTransaction({
                    to: recipient,
                    value: ethers.utils.parseEther(amount)
                });
                
                showToast(`Transaction sent: ${tx.hash.substring(0, 10)}...`, 'success');
                
                const receipt = await tx.wait();
                
                const txData = {
                    hash: tx.hash,
                    from: userAddress,
                    to: recipient,
                    value: amount,
                    status: receipt.status === 1 ? 'success' : 'failed',
                    timestamp: Date.now()
                };
                
                transactions.push(txData);
                localStorage.setItem('karchain_txs', JSON.stringify(transactions));
                
                await updateBalance();
                loadTransactionHistory();
                
                document.getElementById('recipientAddress').value = '';
                document.getElementById('sendAmount').value = '';
                
                showToast('Transaction confirmed!', 'success');
                
            } catch (error) {
                console.error(error);
                showToast(error.message, 'error');
            }
        }

        function loadTransactionHistory() {
            const list = document.getElementById('transactionList');
            const noTx = document.getElementById('noTransactions');
            
            if (!transactions || transactions.length === 0) {
                list.innerHTML = '';
                noTx.classList.remove('hidden');
                return;
            }
            
            noTx.classList.add('hidden');
            
            // Get last 10 transactions
            const recentTxs = [...transactions].reverse().slice(0, 10);
            
            list.innerHTML = recentTxs.map(tx => `
                <div class="transaction-item flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid ${tx.status === 'success' ? 'fa-check-circle text-green-400' : 'fa-times-circle text-red-400'}"></i>
                        <div>
                            <p class="font-bold">${tx.value} KRM</p>
                            <p class="text-xs text-gray-500 font-mono">
                                ${tx.hash.substring(0, 10)}...${tx.hash.substring(58)}
                            </p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-gray-400">${new Date(tx.timestamp).toLocaleDateString()}</p>
                        <p class="text-xs text-gray-500">${new Date(tx.timestamp).toLocaleTimeString()}</p>
                    </div>
                </div>
            `).join('');
        }

        // ==================== FAUCET ====================
        function updateFaucetUI() {
            if (!userAddress) return;
            
            const level1Div = document.getElementById('faucetLevel1');
            const level2Div = document.getElementById('faucetLevel2');
            const level2Card = document.getElementById('level2Card');
            
            const lastClaim1 = localStorage.getItem(`faucet1_${userAddress}`);
            const now = Date.now();
            const cooldown = 24 * 60 * 60 * 1000;
            
            // Level 1
            if (!lastClaim1 || now - parseInt(lastClaim1) >= cooldown) {
                level1Div.innerHTML = `
                    <button onclick="claimLevel1()" class="w-full py-4 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 rounded-xl font-bold transition-all">
                        <i class="fa-solid fa-droplet mr-2"></i>
                        CLAIM 1 KRM
                    </button>
                `;
            } else {
                const timeLeft = cooldown - (now - parseInt(lastClaim1));
                const hours = Math.floor(timeLeft / (60 * 60 * 1000));
                const mins = Math.floor((timeLeft % (60 * 60 * 1000)) / (60 * 1000));
                const secs = Math.floor((timeLeft % (60 * 1000)) / 1000);
                
                level1Div.innerHTML = `
                    <div class="text-center">
                        <p class="text-sm text-gray-400 mb-3">Next claim available in</p>
                        <div class="flex justify-center gap-2">
                            <span class="timer-flip">${hours.toString().padStart(2, '0')}</span>
                            <span class="text-green-400 text-2xl">:</span>
                            <span class="timer-flip">${mins.toString().padStart(2, '0')}</span>
                            <span class="text-green-400 text-2xl">:</span>
                            <span class="timer-flip">${secs.toString().padStart(2, '0')}</span>
                        </div>
                    </div>
                `;
                
                // Update every second
                setTimeout(updateFaucetUI, 1000);
            }
            
            // Level 2
            const level1Completed = lastClaim1 !== null;
            
            if (level1Completed) {
                level2Card.classList.remove('opacity-50');
                level2Div.innerHTML = `
                    <button onclick="claimLevel2()" class="w-full py-4 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 rounded-xl font-bold transition-all">
                        <i class="fa-brands fa-ethereum mr-2"></i>
                        SEND 0.005 ETH FOR 5 KRM
                    </button>
                `;
            } else {
                level2Card.classList.add('opacity-50');
                level2Div.innerHTML = `
                    <div class="text-center py-4">
                        <i class="fa-solid fa-lock text-purple-400 text-2xl mb-2"></i>
                        <p class="text-sm text-gray-400">Complete Level 1 to unlock</p>
                    </div>
                `;
            }
        }

        function claimLevel1() {
            if (!userAddress) {
                showToast('Please connect wallet first', 'error');
                return;
            }
            
            const newBalance = parseFloat(krmBalance || 0) + 1;
            krmBalance = newBalance.toString();
            
            document.getElementById('krmBalance').textContent = newBalance.toFixed(4);
            
            localStorage.setItem(`faucet1_${userAddress}`, Date.now().toString());
            
            showToast('Claimed 1 KRM!', 'success');
            updateFaucetUI();
        }

        async function claimLevel2() {
            if (!signer || !userAddress) {
                showToast('Please connect wallet first', 'error');
                return;
            }
            
            try {
                showToast('Preparing transaction...', 'info');
                
                // Switch to Ethereum mainnet
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0x1' }]
                });
                
                // Update provider
                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                
                const tx = await signer.sendTransaction({
                    to: CONFIG.faucetAddress,
                    value: ethers.utils.parseEther('0.005')
                });
                
                showToast('Payment sent! Waiting for confirmation...', 'info');
                
                await tx.wait();
                
                // Add KRM
                const newBalance = parseFloat(krmBalance || 0) + 5;
                krmBalance = newBalance.toString();
                document.getElementById('krmBalance').textContent = newBalance.toFixed(4);
                
                showToast('Received 5 KRM!', 'success');
                
                // Switch back
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: CONFIG.chainIdHex }]
                });
                
                // Update provider again
                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                
            } catch (error) {
                console.error(error);
                showToast(error.message, 'error');
            }
        }

        // ==================== FAQ ====================
        function toggleFaq(element) {
            const answer = element.nextElementSibling;
            const icon = element.querySelector('i');
            
            answer.classList.toggle('open');
            icon.style.transform = answer.classList.contains('open') ? 'rotate(180deg)' : '';
        }

        // ==================== SCROLL TO TOP ====================
        function setupScrollListener() {
            const scrollBtn = document.getElementById('scrollTop');
            
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) {
                    scrollBtn.style.opacity = '1';
                    scrollBtn.style.pointerEvents = 'all';
                } else {
                    scrollBtn.style.opacity = '0';
                    scrollBtn.style.pointerEvents = 'none';
                }
            });
        }

        // ==================== EXPOSE GLOBALLY ====================
        window.navigateTo = navigateTo;
        window.openModal = openModal;
        window.closeModal = closeModal;
        window.connectWallet = connectWallet;
        window.disconnectWallet = disconnectWallet;
        window.sendToSelf = sendToSelf;
        window.sendTransaction = sendTransaction;
        window.refreshBalance = refreshBalance;
        window.claimLevel1 = claimLevel1;
        window.claimLevel2 = claimLevel2;
        window.toggleMobileMenu = toggleMobileMenu;
        window.toggleFaq = toggleFaq;
        window.loadTransactionHistory = loadTransactionHistory;
    </script>
</body>
</html>
