<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#020402">
    <meta name="description" content="KarChain is the first hyper-scalable Layer-1 blockchain featuring Adaptive State Sharding and Proof-of-Synchrony consensus mechanism.">
    
    <title>KarChain | Testnet Phase 1</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #020402;
            color: #fff;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0a0f0a; }
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(135deg, #22c55e, #15803d);
            border-radius: 4px;
        }

        /* Glass Effect */
        .glass {
            background: rgba(10, 15, 10, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(74, 222, 128, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .glass-card {
            background: linear-gradient(145deg, rgba(20, 25, 20, 0.6), rgba(10, 15, 10, 0.8));
            border: 1px solid rgba(74, 222, 128, 0.1);
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            border-color: rgba(74, 222, 128, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 20px 40px -20px rgba(74, 222, 128, 0.3);
        }

        /* Grid Background */
        .grid-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(74, 222, 128, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(74, 222, 128, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .animate-pulse-slow {
            animation: pulse 4s ease-in-out infinite;
        }

        /* Wallet Button */
        .wallet-btn {
            background: linear-gradient(135deg, #15803d, #22c55e);
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            border: 1px solid rgba(74, 222, 128, 0.3);
            box-shadow: 0 4px 20px rgba(34, 197, 94, 0.2);
        }

        .wallet-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(34, 197, 94, 0.4);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #0a100a;
            border: 1px solid rgba(74, 222, 128, 0.2);
            border-radius: 24px;
            padding: 32px;
            max-width: 400px;
            width: 90%;
            transform: scale(0.9);
            transition: all 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        /* Wallet Option */
        .wallet-option {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .wallet-option:hover {
            background: rgba(74, 222, 128, 0.1);
            border-color: rgba(74, 222, 128, 0.3);
            transform: translateX(4px);
        }

        /* Timer */
        .timer {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(74, 222, 128, 0.2);
            color: #4ade80;
            font-size: 24px;
            font-weight: 600;
        }

        /* Address Display */
        .address-badge {
            background: rgba(74, 222, 128, 0.1);
            padding: 8px 16px;
            border-radius: 30px;
            border: 1px solid rgba(74, 222, 128, 0.2);
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            color: #4ade80;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .address-badge:hover {
            background: rgba(74, 222, 128, 0.2);
            border-color: #4ade80;
        }

        /* Balance Display */
        .balance-large {
            font-size: 48px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            background: linear-gradient(135deg, #fff, #4ade80);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Level Card */
        .level-card {
            background: rgba(20, 25, 20, 0.5);
            border: 1px solid rgba(74, 222, 128, 0.1);
            border-radius: 20px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .level-card.active {
            border-color: #4ade80;
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.2);
        }

        .level-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Task Card */
        .task-card {
            background: rgba(20, 25, 20, 0.5);
            border: 1px solid rgba(74, 222, 128, 0.1);
            border-radius: 20px;
            padding: 24px;
            position: relative;
            transition: all 0.3s ease;
        }

        .task-card.completed {
            border-color: #4ade80;
            background: rgba(74, 222, 128, 0.05);
        }

        .task-card.locked {
            opacity: 0.5;
            filter: grayscale(0.5);
            pointer-events: none;
        }

        .task-card.locked::after {
            content: '\f023';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #4ade80;
            background: rgba(0, 0, 0, 0.8);
            padding: 16px;
            border-radius: 50%;
            z-index: 10;
        }

        /* Performance Fixes */
        .gpu {
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
            will-change: transform;
        }

        /* Mobile Menu */
        .mobile-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 400px;
            height: 100vh;
            background: #0a100a;
            z-index: 1001;
            transition: right 0.3s ease;
            padding: 100px 24px;
            border-left: 1px solid rgba(74, 222, 128, 0.1);
        }

        .mobile-menu.active {
            right: 0;
        }

        .mobile-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: none;
        }

        .mobile-backdrop.active {
            display: block;
        }

        .hamburger {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 21px;
            background: transparent;
            border: none;
            cursor: pointer;
        }

        .hamburger span {
            width: 100%;
            height: 3px;
            background: #4ade80;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -7px);
        }

        @media (max-width: 1024px) {
            .desktop-nav { display: none; }
            .hamburger { display: flex; }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 100px;
            right: 24px;
            padding: 16px 24px;
            border-radius: 12px;
            background: #0a100a;
            border: 1px solid rgba(74, 222, 128, 0.2);
            color: #fff;
            z-index: 2000;
            animation: slideIn 0.3s ease forwards;
            max-width: 350px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Grid Background -->
    <div class="grid-bg"></div>

    <!-- Mobile Menu -->
    <div class="mobile-backdrop" id="mobileBackdrop"></div>
    <div class="mobile-menu" id="mobileMenu">
        <div class="flex flex-col space-y-6">
            <button onclick="App.navigate('home')" class="text-2xl font-bold text-white hover:text-green-400 transition-colors">
                <i class="fa-solid fa-flask mr-3"></i>Testnet
            </button>
            <button onclick="App.navigate('vision')" class="text-2xl font-bold text-gray-500 hover:text-white transition-colors">
                <i class="fa-solid fa-eye mr-3"></i>Vision
            </button>
            <button onclick="App.navigate('ecosystem')" class="text-2xl font-bold text-gray-500 hover:text-white transition-colors">
                <i class="fa-solid fa-cubes mr-3"></i>Ecosystem
            </button>
            <button onclick="App.navigate('support')" class="text-2xl font-bold text-gray-500 hover:text-white transition-colors">
                <i class="fa-solid fa-headset mr-3"></i>Support
            </button>
            
            <div id="mobileWalletInfo" class="hidden mt-8 p-6 glass rounded-xl">
                <p class="text-sm text-gray-400 mb-2">Connected</p>
                <p class="text-sm font-mono text-green-400 break-all" id="mobileAddress"></p>
                <p class="text-xl font-bold mt-4" id="mobileBalance">0.00 KRM</p>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full glass z-50 gpu">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            
            <!-- Logo -->
            <div class="flex items-center gap-4 cursor-pointer" onclick="App.navigate('home')">
                <svg viewBox="0 0 100 100" class="w-12 h-12">
                    <path d="M20 10 V90" stroke="#4ade80" stroke-width="8" stroke-linecap="round"/>
                    <path d="M80 10 L20 50 L80 90" stroke="#4ade80" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="20" cy="50" r="10" fill="#22c55e"/>
                    <circle cx="80" cy="10" r="8" fill="#22c55e"/>
                    <circle cx="80" cy="90" r="8" fill="#22c55e"/>
                </svg>
                <span class="text-xl font-bold tracking-wider text-white">KARCHAIN</span>
            </div>

            <!-- Desktop Nav -->
            <div class="desktop-nav flex items-center gap-8">
                <button onclick="App.navigate('home')" id="nav-home" class="nav-link text-white border-b-2 border-green-500 pb-1">TESTNET</button>
                <button onclick="App.navigate('vision')" id="nav-vision" class="nav-link text-gray-500 hover:text-white">VISION</button>
                <button onclick="App.navigate('ecosystem')" id="nav-ecosystem" class="nav-link text-gray-500 hover:text-white">ECOSYSTEM</button>
                <button onclick="App.navigate('support')" id="nav-support" class="nav-link text-gray-500 hover:text-white">SUPPORT</button>
            </div>

            <!-- Right Section -->
            <div class="flex items-center gap-4">
                <button id="connectBtn" class="wallet-btn" onclick="App.showConnectModal()">
                    <i class="fa-solid fa-wallet mr-2"></i>
                    <span>Connect Wallet</span>
                </button>

                <button class="hamburger" id="hamburgerBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Connect Wallet Modal -->
    <div class="modal" id="connectModal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">Connect Wallet</h3>
                <button onclick="App.hideConnectModal()" class="text-gray-500 hover:text-white">
                    <i class="fa-solid fa-xmark text-2xl"></i>
                </button>
            </div>

            <div class="wallet-option" onclick="App.connectWallet('metamask')">
                <div class="flex items-center gap-4">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg" class="w-8 h-8">
                    <div>
                        <div class="font-bold">MetaMask</div>
                        <div class="text-xs text-gray-500">Connect to browser extension</div>
                    </div>
                </div>
            </div>

            <div class="wallet-option" onclick="App.connectWallet('phantom')">
                <div class="flex items-center gap-4">
                    <i class="fa-solid fa-ghost text-2xl text-purple-400"></i>
                    <div>
                        <div class="font-bold">Phantom</div>
                        <div class="text-xs text-gray-500">Solana & EVM compatible</div>
                    </div>
                </div>
            </div>

            <div class="wallet-option" onclick="App.connectWallet('trust')">
                <div class="flex items-center gap-4">
                    <i class="fa-solid fa-shield-halved text-2xl text-blue-400"></i>
                    <div>
                        <div class="font-bold">Trust Wallet</div>
                        <div class="text-xs text-gray-500">Mobile & desktop</div>
                    </div>
                </div>
            </div>

            <div class="wallet-option" onclick="App.connectWallet('walletconnect')">
                <div class="flex items-center gap-4">
                    <i class="fa-solid fa-qrcode text-2xl text-purple-400"></i>
                    <div>
                        <div class="font-bold">WalletConnect</div>
                        <div class="text-xs text-gray-500">Scan with mobile wallet</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- User Dropdown -->
    <div id="userDropdown" class="fixed top-24 right-6 w-80 glass rounded-2xl p-6 hidden z-50">
        <div class="flex items-center gap-4 mb-4 pb-4 border-b border-white/10">
            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center">
                <i class="fa-solid fa-wallet text-white"></i>
            </div>
            <div>
                <p class="text-sm text-gray-400">Connected</p>
                <p class="text-sm font-mono text-green-400" id="dropdownAddress"></p>
            </div>
        </div>
        
        <div class="space-y-3">
            <div class="flex justify-between p-3 bg-white/5 rounded-lg">
                <span class="text-gray-400">Balance</span>
                <span class="font-bold font-mono" id="dropdownBalance">0.00 KRM</span>
            </div>
            
            <button onclick="App.disconnect()" class="w-full p-3 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors">
                <i class="fa-solid fa-right-from-bracket mr-2"></i>
                Disconnect
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="pt-32 pb-20 px-4 max-w-7xl mx-auto">
        
        <!-- Home Page -->
        <div id="page-home">
            
            <!-- Hero -->
            <div class="text-center mb-16">
                <h1 class="text-5xl md:text-7xl font-bold mb-6">
                    THE ARCHITECTURE OF
                    <span class="block text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-green-600">
                        DIGITAL TRUST
                    </span>
                </h1>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    Join the Incentivized Testnet and secure your place in the genesis block.
                </p>
            </div>

            <!-- Dashboard -->
            <div class="glass rounded-3xl p-8">
                
                <!-- Locked View -->
                <div id="view-locked" class="text-center py-20">
                    <div class="w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fa-solid fa-lock text-4xl text-gray-600"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-4">Dashboard Locked</h2>
                    <p class="text-gray-400 mb-8 max-w-md mx-auto">Connect your wallet to access the testnet dashboard and claim daily tokens.</p>
                    <button onclick="App.showConnectModal()" class="wallet-btn px-8 py-4">
                        <i class="fa-solid fa-wallet mr-2"></i>
                        Connect Wallet
                    </button>
                </div>

                <!-- Active View -->
                <div id="view-active" class="hidden">
                    
                    <!-- Balance Header -->
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 pb-8 border-b border-white/10">
                        <div>
                            <p class="text-sm text-gray-400 mb-2">Available Balance</p>
                            <div class="flex items-baseline gap-4">
                                <span id="balanceVal" class="balance-large">0.00</span>
                                <span class="text-2xl text-green-400">KRM</span>
                            </div>
                        </div>
                        
                        <div class="mt-4 md:mt-0">
                            <div class="address-badge" onclick="App.copyAddress()" id="walletAddress">
                                0x0000...0000
                            </div>
                            <p class="text-xs text-gray-500 mt-2 text-right">Click to copy</p>
                        </div>
                    </div>

                    <!-- Faucet Levels -->
                    <div class="mb-12">
                        <h3 class="text-2xl font-bold mb-6 flex items-center gap-3">
                            <i class="fa-solid fa-water text-green-400"></i>
                            Faucet
                        </h3>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            
                            <!-- Level 1 -->
                            <div class="level-card relative" id="level1-card">
                                <div class="level-badge bg-green-500/20 text-green-400 border border-green-500/30">
                                    Level 1
                                </div>
                                
                                <div class="flex items-center gap-4 mb-4">
                                    <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center">
                                        <i class="fa-solid fa-droplet text-white text-2xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-xl font-bold">Free Faucet</h4>
                                        <p class="text-sm text-gray-400">1 KRM every 24 hours</p>
                                    </div>
                                </div>
                                
                                <div id="faucet-level1" class="mt-4"></div>
                            </div>
                            
                            <!-- Level 2 -->
                            <div class="level-card relative opacity-70" id="level2-card">
                                <div class="level-badge bg-purple-500/20 text-purple-400 border border-purple-500/30">
                                    Level 2
                                </div>
                                
                                <div class="flex items-center gap-4 mb-4">
                                    <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center">
                                        <i class="fa-brands fa-ethereum text-white text-2xl"></i>
                                    </div>
                                    <div>
                                        <h4 class="text-xl font-bold">Premium Faucet</h4>
                                        <p class="text-sm text-gray-400">5 KRM for 0.005 ETH</p>
                                    </div>
                                </div>
                                
                                <div id="faucet-level2" class="mt-4"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Tasks -->
                    <h3 class="text-2xl font-bold mb-6 flex items-center gap-3">
                        <i class="fa-solid fa-list-check text-green-400"></i>
                        Testnet Tasks
                    </h3>
                    
                    <div class="grid md:grid-cols-3 gap-6">
                        
                        <!-- Task 1: Social -->
                        <div class="task-card" id="task1">
                            <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center mb-4 text-2xl text-blue-400">
                                <i class="fa-brands fa-x-twitter"></i>
                            </div>
                            <h4 class="text-lg font-bold mb-2">Social Identity</h4>
                            <p class="text-sm text-gray-400 mb-4">Follow on X and join Telegram</p>
                            
                            <div class="space-y-3">
                                <button onclick="window.open('https://x.com/karim7652117665', '_blank')" class="w-full py-3 bg-[#1DA1F2] rounded-lg text-sm font-bold">
                                    <i class="fa-brands fa-x-twitter mr-2"></i>
                                    Follow
                                </button>
                                <button onclick="window.open('https://t.me/tgkarim1', '_blank')" class="w-full py-3 bg-[#0088cc] rounded-lg text-sm font-bold">
                                    <i class="fa-brands fa-telegram mr-2"></i>
                                    Join
                                </button>
                                <button id="verifySocialBtn" onclick="App.completeTask(1)" disabled class="w-full py-3 bg-gray-600 rounded-lg text-sm font-bold cursor-not-allowed">
                                    <i class="fa-solid fa-check-circle mr-2"></i>
                                    Verify
                                </button>
                            </div>
                            
                            <div class="mt-4 pt-4 border-t border-white/10">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-400">Reward</span>
                                    <span class="text-green-400 font-bold">+10 KRM</span>
                                </div>
                            </div>
                        </div>

                        <!-- Task 2: Transaction -->
                        <div class="task-card locked" id="task2">
                            <div class="w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center mb-4 text-2xl text-purple-400">
                                <i class="fa-solid fa-arrow-right-arrow-left"></i>
                            </div>
                            <h4 class="text-lg font-bold mb-2">First Transaction</h4>
                            <p class="text-sm text-gray-400 mb-4">Send any transaction on KarChain</p>
                            
                            <div class="space-y-3">
                                <button onclick="App.sendTransaction()" class="w-full py-3 bg-purple-600 rounded-lg text-sm font-bold">
                                    <i class="fa-solid fa-bolt mr-2"></i>
                                    Send 0.001 KRM
                                </button>
                                <button id="verifyTxBtn" onclick="App.verifyTransaction()" disabled class="w-full py-3 bg-gray-600 rounded-lg text-sm font-bold cursor-not-allowed">
                                    <i class="fa-solid fa-magnifying-glass mr-2"></i>
                                    Verify
                                </button>
                            </div>
                            
                            <div class="mt-4 pt-4 border-t border-white/10">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-400">Reward</span>
                                    <span class="text-green-400 font-bold">+25 KRM</span>
                                </div>
                            </div>
                        </div>

                        <!-- Task 3: Form -->
                        <div class="task-card locked" id="task3">
                            <div class="w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center mb-4 text-2xl text-orange-400">
                                <i class="fa-solid fa-file-signature"></i>
                            </div>
                            <h4 class="text-lg font-bold mb-2">Genesis Registration</h4>
                            <p class="text-sm text-gray-400 mb-4">Submit your wallet for genesis block</p>
                            
                            <button onclick="App.openForm()" class="w-full py-3 bg-orange-600 rounded-lg text-sm font-bold opacity-50 pointer-events-none" id="formBtn">
                                <i class="fa-solid fa-pen-to-square mr-2"></i>
                                Open Form
                            </button>
                            
                            <div class="mt-4 pt-4 border-t border-white/10">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-400">Reward</span>
                                    <span class="text-green-400 font-bold">+50 KRM</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Progress -->
                    <div class="mt-8 pt-8 border-t border-white/10">
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-gray-400">Overall Progress</span>
                            <span class="text-green-400 font-bold" id="progressText">0/3 Tasks</span>
                        </div>
                        <div class="w-full h-3 bg-white/10 rounded-full overflow-hidden">
                            <div id="progressBar" class="h-full bg-gradient-to-r from-green-500 to-green-400 w-0 transition-all duration-500"></div>
                        </div>
                        <p class="text-right mt-2 text-sm text-gray-500" id="totalReward">+0 KRM</p>
                    </div>

                    <!-- Transaction History -->
                    <div id="txHistory" class="mt-8 hidden">
                        <h4 class="text-lg font-bold mb-4">Recent Transactions</h4>
                        <div id="txList" class="space-y-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vision Page -->
        <div id="page-vision" class="hidden">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-bold mb-6">THE <span class="text-green-400">MANIFESTO</span></h2>
                <p class="text-xl text-gray-400">Re-engineering the fundamental substrate of human coordination.</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-12">
                <div class="glass-card p-8 rounded-2xl">
                    <h3 class="text-3xl font-bold mb-4 text-green-400">01 // Asynchronous Finality</h3>
                    <p class="text-gray-300 leading-relaxed">KarChain introduces Hyper-Graph Sharding with Proof-of-Synchrony consensus, achieving mathematical finality in sub-second timeframes.</p>
                </div>
                <div class="glass-card p-8 rounded-2xl">
                    <h3 class="text-3xl font-bold mb-4 text-green-400">02 // Post-Quantum Security</h3>
                    <p class="text-gray-300 leading-relaxed">Built as a quantum fortress using Lattice-based signatures (Kyber/Dilithium) to secure assets against future quantum threats.</p>
                </div>
            </div>
        </div>

        <!-- Ecosystem Page -->
        <div id="page-ecosystem" class="hidden">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-bold mb-6">ECOSYSTEM</h2>
                <p class="text-xl text-gray-400">Building the future on KarChain</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6">
                <div class="glass-card p-8 rounded-2xl">
                    <i class="fa-solid fa-arrow-right-arrow-left text-4xl text-purple-400 mb-4"></i>
                    <h3 class="text-xl font-bold mb-2">KarSwap DEX</h3>
                    <p class="text-gray-400">Native AMM with concentrated liquidity</p>
                </div>
                <div class="glass-card p-8 rounded-2xl">
                    <i class="fa-solid fa-vault text-4xl text-blue-400 mb-4"></i>
                    <h3 class="text-xl font-bold mb-2">KarVault Lending</h3>
                    <p class="text-gray-400">Cross-chain lending protocol</p>
                </div>
                <div class="glass-card p-8 rounded-2xl">
                    <i class="fa-solid fa-shield-halved text-4xl text-green-400 mb-4"></i>
                    <h3 class="text-xl font-bold mb-2">KarSafe</h3>
                    <p class="text-gray-400">Multi-sig institutional wallet</p>
                </div>
            </div>
        </div>

        <!-- Support Page -->
        <div id="page-support" class="hidden">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-bold mb-6">SUPPORT</h2>
                <p class="text-xl text-gray-400">Get help from the community</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <a href="https://t.me/tgkarim1" target="_blank" class="glass-card p-8 rounded-2xl block">
                    <i class="fa-brands fa-telegram text-4xl text-blue-400 mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">Telegram</h3>
                    <p class="text-gray-400">Join 50,000+ members</p>
                </a>
                <a href="mailto:support@karchain.io" class="glass-card p-8 rounded-2xl block">
                    <i class="fa-solid fa-envelope text-4xl text-green-400 mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">Email</h3>
                    <p class="text-gray-400">support@karchain.io</p>
                </a>
            </div>
        </div>
    </div>

    <script>
        // KarChain Configuration
        const KARCHAIN_CONFIG = {
            chainId: '0x539', // 1337
            chainIdDecimal: 1337,
            chainName: 'KarChain Testnet',
            rpcUrl: 'https://rpc.karchain.network',
            symbol: 'KRM',
            decimals: 18,
            explorer: 'https://explorer.karchain.network'
        };

        // App State
        const App = {
            state: {
                address: null,
                provider: null,
                signer: null,
                balance: '0.00',
                tasks: JSON.parse(localStorage.getItem('karchain_tasks') || '[]'),
                transactions: JSON.parse(localStorage.getItem('karchain_txs') || '[]'),
                lastFaucetClaim: localStorage.getItem('karchain_last_claim') || 0,
                level2Unlocked: localStorage.getItem('karchain_level2') === 'true'
            },

            // Navigation
            navigate(page) {
                document.querySelectorAll('[id^="page-"]').forEach(p => p.classList.add('hidden'));
                document.getElementById(`page-${page}`).classList.remove('hidden');
                
                document.querySelectorAll('.nav-link').forEach(l => {
                    l.classList.remove('text-white', 'border-green-500');
                    l.classList.add('text-gray-500');
                });
                
                const active = document.getElementById(`nav-${page}`);
                if (active) {
                    active.classList.remove('text-gray-500');
                    active.classList.add('text-white', 'border-green-500');
                }
                
                this.closeMobileMenu();
            },

            // Mobile Menu
            initMobileMenu() {
                const hamburger = document.getElementById('hamburgerBtn');
                const menu = document.getElementById('mobileMenu');
                const backdrop = document.getElementById('mobileBackdrop');
                
                if (hamburger) {
                    hamburger.addEventListener('click', () => {
                        menu.classList.toggle('active');
                        backdrop.classList.toggle('active');
                        hamburger.classList.toggle('active');
                    });
                }
                
                if (backdrop) {
                    backdrop.addEventListener('click', () => this.closeMobileMenu());
                }
            },

            closeMobileMenu() {
                document.getElementById('mobileMenu')?.classList.remove('active');
                document.getElementById('mobileBackdrop')?.classList.remove('active');
                document.getElementById('hamburgerBtn')?.classList.remove('active');
            },

            // Modal
            showConnectModal() {
                document.getElementById('connectModal').classList.add('active');
            },

            hideConnectModal() {
                document.getElementById('connectModal').classList.remove('active');
            },

            // Wallet Connection
            async connectWallet(type) {
                this.hideConnectModal();
                
                const connectBtn = document.getElementById('connectBtn');
                const originalText = connectBtn.innerHTML;
                connectBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i>Connecting...';

                try {
                    let provider, accounts;

                    // MetaMask
                    if (type === 'metamask') {
                        if (!window.ethereum) {
                            window.open('https://metamask.io/download/', '_blank');
                            throw new Error('Please install MetaMask');
                        }
                        
                        provider = new ethers.providers.Web3Provider(window.ethereum);
                        await provider.send('eth_requestAccounts', []);
                        
                        // Switch to KarChain
                        try {
                            await window.ethereum.request({
                                method: 'wallet_switchEthereumChain',
                                params: [{ chainId: KARCHAIN_CONFIG.chainId }]
                            });
                        } catch (switchError) {
                            if (switchError.code === 4902) {
                                await window.ethereum.request({
                                    method: 'wallet_addEthereumChain',
                                    params: [{
                                        chainId: KARCHAIN_CONFIG.chainId,
                                        chainName: KARCHAIN_CONFIG.chainName,
                                        rpcUrls: [KARCHAIN_CONFIG.rpcUrl],
                                        nativeCurrency: {
                                            name: 'KarChain',
                                            symbol: KARCHAIN_CONFIG.symbol,
                                            decimals: KARCHAIN_CONFIG.decimals
                                        },
                                        blockExplorerUrls: [KARCHAIN_CONFIG.explorer]
                                    }]
                                });
                            }
                        }
                        
                        accounts = await provider.listAccounts();
                    }
                    
                    // Phantom
                    else if (type === 'phantom') {
                        if (!window.phantom?.ethereum) {
                            window.open('https://phantom.app/', '_blank');
                            throw new Error('Please install Phantom');
                        }
                        
                        provider = new ethers.providers.Web3Provider(window.phantom.ethereum);
                        await window.phantom.ethereum.request({ method: 'eth_requestAccounts' });
                        accounts = await provider.listAccounts();
                    }
                    
                    // Trust Wallet
                    else if (type === 'trust') {
                        if (!window.ethereum || !window.ethereum.isTrust) {
                            window.open('https://trustwallet.com/', '_blank');
                            throw new Error('Please install Trust Wallet');
                        }
                        
                        provider = new ethers.providers.Web3Provider(window.ethereum);
                        await provider.send('eth_requestAccounts', []);
                        accounts = await provider.listAccounts();
                    }
                    
                    // WalletConnect
                    else if (type === 'walletconnect') {
                        this.showNotification('WalletConnect QR will appear', 'info');
                        // For now, use MetaMask
                        return this.connectWallet('metamask');
                    }

                    if (!accounts || accounts.length === 0) {
                        throw new Error('No accounts found');
                    }

                    this.state.address = accounts[0];
                    this.state.provider = provider;
                    this.state.signer = provider.getSigner();

                    // Load balance
                    await this.updateBalance();

                    // Save connection
                    localStorage.setItem('karchain_wallet', this.state.address);
                    
                    // Update UI
                    this.updateUI();
                    this.showNotification('Wallet connected successfully!', 'success');
                    
                    // Setup listeners
                    this.setupWalletListeners();

                } catch (error) {
                    console.error('Connection error:', error);
                    this.showNotification(error.message, 'error');
                } finally {
                    connectBtn.innerHTML = originalText;
                }
            },

            setupWalletListeners() {
                const provider = window.ethereum || window.phantom?.ethereum;
                if (!provider) return;

                provider.on('accountsChanged', (accounts) => {
                    if (accounts.length === 0) {
                        this.disconnect();
                    } else {
                        this.state.address = accounts[0];
                        this.updateBalance();
                        this.updateUI();
                    }
                });

                provider.on('chainChanged', (chainId) => {
                    if (parseInt(chainId) !== KARCHAIN_CONFIG.chainIdDecimal) {
                        this.showNotification('Please switch to KarChain network', 'warning');
                    }
                });
            },

            async updateBalance() {
                if (!this.state.provider || !this.state.address) return;
                
                try {
                    const balance = await this.state.provider.getBalance(this.state.address);
                    this.state.balance = ethers.utils.formatEther(balance);
                    
                    // Update displays
                    document.getElementById('balanceVal').textContent = parseFloat(this.state.balance).toFixed(4);
                    document.getElementById('dropdownBalance').textContent = parseFloat(this.state.balance).toFixed(4) + ' KRM';
                    document.getElementById('mobileBalance').textContent = parseFloat(this.state.balance).toFixed(4) + ' KRM';
                    
                    localStorage.setItem('karchain_balance', this.state.balance);
                } catch (error) {
                    console.error('Balance update error:', error);
                }
            },

            // UI Update
            updateUI() {
                if (!this.state.address) return;
                
                // Format address
                const shortAddress = this.state.address.substring(0, 6) + '...' + this.state.address.substring(38);
                
                // Update buttons
                document.getElementById('connectBtn').innerHTML = `
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse mr-2"></div>
                    ${shortAddress}
                `;
                
                // Update displays
                document.getElementById('walletAddress').textContent = shortAddress;
                document.getElementById('dropdownAddress').textContent = shortAddress;
                document.getElementById('mobileAddress').textContent = this.state.address;
                
                // Show active view
                document.getElementById('view-locked').classList.add('hidden');
                document.getElementById('view-active').classList.remove('hidden');
                
                // Show mobile wallet info
                document.getElementById('mobileWalletInfo').classList.remove('hidden');
                
                // Update faucet
                this.updateFaucetUI();
                
                // Update tasks
                this.updateTasksUI();
            },

            // Faucet
            updateFaucetUI() {
                const lastClaim = parseInt(localStorage.getItem('karchain_last_claim') || '0');
                const now = Date.now();
                const cooldown = 24 * 60 * 60 * 1000; // 24 hours
                
                const level1Div = document.getElementById('faucet-level1');
                const level2Div = document.getElementById('faucet-level2');
                
                if (now - lastClaim < cooldown) {
                    // Show timer
                    const timeLeft = cooldown - (now - lastClaim);
                    const hours = Math.floor(timeLeft / (60 * 60 * 1000));
                    const minutes = Math.floor((timeLeft % (60 * 60 * 1000)) / (60 * 1000));
                    const seconds = Math.floor((timeLeft % (60 * 1000)) / 1000);
                    
                    level1Div.innerHTML = `
                        <div class="text-center">
                            <p class="text-sm text-gray-400 mb-3">Next claim in</p>
                            <div class="flex items-center justify-center gap-2">
                                <div class="timer">${hours.toString().padStart(2, '0')}</div>
                                <span class="text-green-400 text-2xl">:</span>
                                <div class="timer">${minutes.toString().padStart(2, '0')}</div>
                                <span class="text-green-400 text-2xl">:</span>
                                <div class="timer">${seconds.toString().padStart(2, '0')}</div>
                            </div>
                        </div>
                    `;
                    
                    // Level 1 claimed, unlock level 2
                    this.state.level2Unlocked = true;
                    localStorage.setItem('karchain_level2', 'true');
                    
                } else {
                    // Show claim button
                    level1Div.innerHTML = `
                        <button onclick="App.claimFaucet()" class="w-full py-4 bg-gradient-to-r from-green-500 to-green-600 rounded-xl font-bold text-lg transition-all hover:shadow-lg hover:shadow-green-500/20">
                            <i class="fa-solid fa-droplet mr-2"></i>
                            CLAIM 1 KRM
                        </button>
                    `;
                }
                
                // Level 2 UI
                if (this.state.level2Unlocked) {
                    document.getElementById('level2-card').classList.remove('opacity-70');
                    
                    level2Div.innerHTML = `
                        <button onclick="App.claimLevel2()" class="w-full py-4 bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl font-bold text-lg transition-all hover:shadow-lg hover:shadow-purple-500/20">
                            <i class="fa-brands fa-ethereum mr-2"></i>
                            SEND 0.005 ETH FOR 5 KRM
                        </button>
                        <p class="text-xs text-gray-500 text-center mt-2">â‰ˆ $10 USD</p>
                    `;
                } else {
                    level2Div.innerHTML = `
                        <div class="text-center p-4 bg-white/5 rounded-lg">
                            <i class="fa-solid fa-lock text-purple-400 text-2xl mb-2"></i>
                            <p class="text-sm text-gray-400">Complete Level 1 to unlock</p>
                        </div>
                    `;
                }
            },

            async claimFaucet() {
                if (!this.state.address) return;
                
                // Simulate claim (in real app, this would interact with smart contract)
                const currentBalance = parseFloat(this.state.balance);
                const newBalance = currentBalance + 1;
                this.state.balance = newBalance.toString();
                
                // Update displays
                document.getElementById('balanceVal').textContent = newBalance.toFixed(4);
                document.getElementById('dropdownBalance').textContent = newBalance.toFixed(4) + ' KRM';
                document.getElementById('mobileBalance').textContent = newBalance.toFixed(4) + ' KRM';
                
                // Save claim time
                const now = Date.now();
                localStorage.setItem('karchain_last_claim', now.toString());
                
                // Unlock level 2
                this.state.level2Unlocked = true;
                localStorage.setItem('karchain_level2', 'true');
                
                // Update UI
                this.updateFaucetUI();
                this.showNotification('Claimed 1 KRM! Level 2 unlocked!', 'success');
                
                // Start countdown
                this.startFaucetTimer();
            },

            startFaucetTimer() {
                const timer = setInterval(() => {
                    const lastClaim = parseInt(localStorage.getItem('karchain_last_claim') || '0');
                    const now = Date.now();
                    const cooldown = 24 * 60 * 60 * 1000;
                    
                    if (now - lastClaim >= cooldown) {
                        this.updateFaucetUI();
                        clearInterval(timer);
                    } else {
                        this.updateFaucetUI();
                    }
                }, 1000);
            },

            async claimLevel2() {
                if (!this.state.address || !this.state.provider) return;
                
                try {
                    // Switch to Ethereum mainnet for payment
                    await window.ethereum.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: '0x1' }]
                    });
                    
                    // Send transaction
                    const signer = this.state.provider.getSigner();
                    const tx = await signer.sendTransaction({
                        to: '0x742d35Cc6634C0532925a3b844Bc454e4438f44e',
                        value: ethers.utils.parseEther('0.005')
                    });
                    
                    this.showNotification('Transaction sent! Waiting for confirmation...', 'info');
                    
                    await tx.wait();
                    
                    // Add to history
                    this.addTransaction({
                        hash: tx.hash,
                        to: '0x742d...f44e',
                        value: '0.005 ETH',
                        type: 'faucet'
                    });
                    
                    // Add KRM
                    const currentBalance = parseFloat(this.state.balance);
                    const newBalance = currentBalance + 5;
                    this.state.balance = newBalance.toString();
                    
                    document.getElementById('balanceVal').textContent = newBalance.toFixed(4);
                    document.getElementById('dropdownBalance').textContent = newBalance.toFixed(4) + ' KRM';
                    
                    this.showNotification('Transaction confirmed! +5 KRM', 'success');
                    
                } catch (error) {
                    console.error('Level 2 claim error:', error);
                    this.showNotification(error.message, 'error');
                }
            },

            // Tasks
            updateTasksUI() {
                const tasks = this.state.tasks;
                
                // Task 1
                if (tasks.includes(1)) {
                    document.getElementById('task1').classList.add('completed');
                    document.getElementById('verifySocialBtn').innerHTML = '<i class="fa-solid fa-check-circle mr-2"></i>Completed';
                    document.getElementById('verifySocialBtn').disabled = true;
                    document.getElementById('verifySocialBtn').classList.add('bg-green-600');
                } else {
                    // Check if social links clicked
                    const socialStarted = localStorage.getItem('social_started');
                    if (socialStarted) {
                        document.getElementById('verifySocialBtn').disabled = false;
                        document.getElementById('verifySocialBtn').classList.remove('bg-gray-600', 'cursor-not-allowed');
                        document.getElementById('verifySocialBtn').classList.add('bg-green-600', 'cursor-pointer');
                    }
                }
                
                // Task 2 (unlocked after task 1)
                if (tasks.includes(1) && !tasks.includes(2)) {
                    document.getElementById('task2').classList.remove('locked');
                }
                
                if (tasks.includes(2)) {
                    document.getElementById('task2').classList.add('completed');
                    document.getElementById('verifyTxBtn').innerHTML = '<i class="fa-solid fa-check-circle mr-2"></i>Completed';
                    document.getElementById('verifyTxBtn').disabled = true;
                }
                
                // Task 3 (unlocked after task 2)
                if (tasks.includes(2) && !tasks.includes(3)) {
                    document.getElementById('task3').classList.remove('locked');
                    document.getElementById('formBtn').classList.remove('opacity-50', 'pointer-events-none');
                }
                
                if (tasks.includes(3)) {
                    document.getElementById('task3').classList.add('completed');
                    document.getElementById('formBtn').innerHTML = '<i class="fa-solid fa-check-circle mr-2"></i>Completed';
                }
                
                // Update progress
                const progress = (tasks.length / 3) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
                document.getElementById('progressText').textContent = tasks.length + '/3 Tasks';
                
                const rewards = tasks.reduce((sum, t) => sum + (t === 1 ? 10 : t === 2 ? 25 : 50), 0);
                document.getElementById('totalReward').textContent = '+' + rewards + ' KRM';
            },

            completeTask(taskId) {
                if (!this.state.tasks.includes(taskId)) {
                    this.state.tasks.push(taskId);
                    localStorage.setItem('karchain_tasks', JSON.stringify(this.state.tasks));
                    
                    // Add reward
                    const reward = taskId === 1 ? 10 : taskId === 2 ? 25 : 50;
                    const currentBalance = parseFloat(this.state.balance);
                    const newBalance = currentBalance + reward;
                    this.state.balance = newBalance.toString();
                    
                    document.getElementById('balanceVal').textContent = newBalance.toFixed(4);
                    document.getElementById('dropdownBalance').textContent = newBalance.toFixed(4) + ' KRM';
                    
                    this.updateTasksUI();
                    this.showNotification(`Task completed! +${reward} KRM`, 'success');
                }
            },

            // Social verification
            initSocialVerification() {
                document.querySelectorAll('[onclick*="open"]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        localStorage.setItem('social_started', 'true');
                        setTimeout(() => this.updateTasksUI(), 1000);
                    });
                });
            },

            // Transaction
            async sendTransaction() {
                if (!this.state.signer) return;
                
                try {
                    const tx = await this.state.signer.sendTransaction({
                        to: this.state.address, // Send to self
                        value: ethers.utils.parseEther('0.001')
                    });
                    
                    this.showNotification('Transaction sent!', 'success');
                    
                    // Wait for confirmation
                    await tx.wait();
                    
                    this.addTransaction({
                        hash: tx.hash,
                        to: this.state.address,
                        value: '0.001 KRM',
                        type: 'test'
                    });
                    
                    // Enable verify button
                    document.getElementById('verifyTxBtn').disabled = false;
                    document.getElementById('verifyTxBtn').classList.remove('bg-gray-600', 'cursor-not-allowed');
                    document.getElementById('verifyTxBtn').classList.add('bg-purple-600', 'cursor-pointer');
                    
                } catch (error) {
                    this.showNotification(error.message, 'error');
                }
            },

            verifyTransaction() {
                this.completeTask(2);
            },

            openForm() {
                if (!this.state.address) return;
                
                const formUrl = 'https://docs.google.com/forms/d/e/1FAIpQLSeQhBQZ_XKxYp2G5bZ5RwTzR2QmPpLJ6xN3oYjH7sKvP8t0w/viewform?entry.1234567890=' + 
                    encodeURIComponent(this.state.address);
                window.open(formUrl, '_blank');
                
                setTimeout(() => this.completeTask(3), 2000);
            },

            // Transaction History
            addTransaction(tx) {
                this.state.transactions.push({
                    ...tx,
                    time: new Date().toISOString()
                });
                localStorage.setItem('karchain_txs', JSON.stringify(this.state.transactions));
                this.updateTransactionHistory();
            },

            updateTransactionHistory() {
                if (this.state.transactions.length === 0) return;
                
                const history = document.getElementById('txHistory');
                const list = document.getElementById('txList');
                
                history.classList.remove('hidden');
                list.innerHTML = '';
                
                this.state.transactions.slice(-5).reverse().forEach(tx => {
                    const el = document.createElement('div');
                    el.className = 'flex justify-between items-center p-3 bg-white/5 rounded-lg';
                    el.innerHTML = `
                        <div>
                            <p class="text-sm font-mono">${tx.hash ? tx.hash.substring(0, 10) + '...' : 'Faucet Claim'}</p>
                            <p class="text-xs text-gray-500">${new Date(tx.time).toLocaleString()}</p>
                        </div>
                        <span class="text-green-400 font-bold">+${tx.value}</span>
                    `;
                    list.appendChild(el);
                });
            },

            // Copy address
            copyAddress() {
                navigator.clipboard.writeText(this.state.address);
                this.showNotification('Address copied!', 'success');
            },

            // Disconnect
            disconnect() {
                this.state.address = null;
                this.state.provider = null;
                this.state.signer = null;
                this.state.balance = '0.00';
                
                localStorage.removeItem('karchain_wallet');
                
                // Update UI
                document.getElementById('connectBtn').innerHTML = '<i class="fa-solid fa-wallet mr-2"></i><span>Connect Wallet</span>';
                document.getElementById('view-locked').classList.remove('hidden');
                document.getElementById('view-active').classList.add('hidden');
                document.getElementById('mobileWalletInfo').classList.add('hidden');
                document.getElementById('userDropdown').classList.add('hidden');
                
                this.showNotification('Wallet disconnected', 'info');
            },

            // Notification
            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification border-l-4 ${
                    type === 'success' ? 'border-green-500' :
                    type === 'error' ? 'border-red-500' :
                    'border-blue-500'
                }`;
                notification.innerHTML = message;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideIn 0.3s ease reverse';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            },

            // Auto reconnect
            async autoReconnect() {
                const savedWallet = localStorage.getItem('karchain_wallet');
                if (!savedWallet) return;
                
                if (window.ethereum) {
                    try {
                        const provider = new ethers.providers.Web3Provider(window.ethereum);
                        const accounts = await provider.listAccounts();
                        
                        if (accounts.length > 0 && accounts[0].toLowerCase() === savedWallet.toLowerCase()) {
                            this.state.address = accounts[0];
                            this.state.provider = provider;
                            this.state.signer = provider.getSigner();
                            
                            await this.updateBalance();
                            this.updateUI();
                            this.setupWalletListeners();
                        }
                    } catch (error) {
                        console.log('Auto reconnect failed:', error);
                    }
                }
            },

            // Initialize
            init() {
                this.initMobileMenu();
                this.initSocialVerification();
                this.autoReconnect();
                
                // Start faucet timer if needed
                const lastClaim = localStorage.getItem('karchain_last_claim');
                if (lastClaim) {
                    const now = Date.now();
                    const cooldown = 24 * 60 * 60 * 1000;
                    if (now - parseInt(lastClaim) < cooldown) {
                        this.startFaucetTimer();
                    }
                }
                
                // Load tasks
                this.state.tasks = JSON.parse(localStorage.getItem('karchain_tasks') || '[]');
                this.state.transactions = JSON.parse(localStorage.getItem('karchain_txs') || '[]');
                this.state.level2Unlocked = localStorage.getItem('karchain_level2') === 'true';
                
                // Load balance if exists
                const savedBalance = localStorage.getItem('karchain_balance');
                if (savedBalance) {
                    this.state.balance = savedBalance;
                }
                
                // Dropdown toggle
                document.getElementById('connectBtn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (this.state.address) {
                        document.getElementById('userDropdown').classList.toggle('hidden');
                    } else {
                        this.showConnectModal();
                    }
                });
                
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#userDropdown') && !e.target.closest('#connectBtn')) {
                        document.getElementById('userDropdown').classList.add('hidden');
                    }
                });
                
                // Performance fixes
                if (navigator.userAgent.indexOf('Chrome') > -1) {
                    document.body.style.webkitFontSmoothing = 'antialiased';
                }
            }
        };

        // Start app
        window.addEventListener('load', () => App.init());
    </script>
</body>
</html>
